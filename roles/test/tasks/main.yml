---

# Â© Copyright EnterpriseDB UK Limited 2015-2024 - All rights reserved.

# This is a collection of non-destructive tests that are generally
# applicable to any cluster.

- include_tasks: prereqs.yml

- name: Run system-level tests
  include_tasks:
    file: sys.yml

- name: Run postgres tests
  include_tasks:
    file: postgres.yml
  when: >
    'postgres' in role and pgdata_initialised

- name: Run barman tests
  include_tasks:
    file: barman.yml
  when: >
    'barman' in role

- name: Run pg-backup-api tests
  include_tasks:
    file: pg-backup-api.yml
  when: >
    'barman' in role and
    enable_pg_backup_api|default(False)|bool

- name: Run pgbouncer tests
  include_tasks:
    file: pgbouncer.yml
  when: >
    'pgbouncer' in role

- name: Run haproxy tests
  include_tasks:
    file: haproxy.yml
  when: >
    'haproxy' in role

- name: Run harp-proxy tests
  include_tasks:
    file: harp-proxy.yml
  when: >
    'harp-proxy' in role

- name: Run pgd-proxy tests
  include_tasks:
    file: pgd-proxy.yml
  when: >
    'pgd-proxy' in role
