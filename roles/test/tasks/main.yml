---

# Copyright Â© 2ndQuadrant Limited <info@2ndquadrant.com>

# This is a collection of non-destructive tests that are generally
# applicable to any cluster.

- include_tasks: prereqs.yml
  tags: always

- include_tasks: test-facts.yml
  tags: always

- name: Run system-level tests
  include_tasks:
    file: sys.yml
    apply:
      tags: sys
  tags: always

- name: Run postgres tests
  include_tasks:
    file: postgres.yml
    apply:
      tags: postgres
  when: >
    'postgres' in role and pgdata_initialised
  tags: always

- name: Run barman tests
  include_tasks:
    file: barman.yml
    apply:
      tags: barman
  when: >
    'barman' in role
  tags: always

- name: Run pgbouncer tests
  include_tasks:
    file: pgbouncer.yml
    apply:
      tags: pgbouncer
  when: >
    'pgbouncer' in role
  tags: pgbouncer
