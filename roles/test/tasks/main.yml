---

# Copyright Â© EnterpriseDB Corporation

# This is a collection of non-destructive tests that are generally
# applicable to any cluster.

- include_tasks: prereqs.yml
  tags: always

- name: Run system-level tests
  include_tasks:
    file: sys.yml
    apply:
      tags: sys
  tags: always

- name: Run postgres tests
  include_tasks:
    file: postgres.yml
    apply:
      tags: postgres
  when: >
    'postgres' in role and pgdata_initialised
  tags: always

- name: Run barman tests
  include_tasks:
    file: barman.yml
    apply:
      tags: barman
  when: >
    'barman' in role
  tags: barman

- name: Run pgbouncer tests
  include_tasks:
    file: pgbouncer.yml
    apply:
      tags: pgbouncer
  when: >
    'pgbouncer' in role
  tags: pgbouncer

- name: Run haproxy tests
  include_tasks:
    file: haproxy.yml
    apply:
      tags: haproxy
  when: >
    'haproxy' in role
  tags: haproxy
