---

# Copyright © 2ndQuadrant Limited <info@2ndquadrant.com>

- assert:
    msg: "output_dir must be defined"
    that: output_dir is defined
  tags: always

- name: Ensure that each instance has an output subdirectory
  file:
    path: "{{ output_dir }}/{{ inventory_hostname }}"
    state: directory
  delegate_to: localhost
  tags: always

- name: Check if destructive tests should be run
  assert:
    msg: "You must run ``tpaexec test … --destroy-this-cluster`` to run destructive tests"
    that:
    - destroy_cluster|default(False)
  when: destructive|default(False)
  run_once: true
  tags: always
