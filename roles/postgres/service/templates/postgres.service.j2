[Unit]
Description=Postgres {{ postgres_version }} (TPA)
After=syslog.target
After=network.target

[Service]
Type=simple
User={{ postgres_user }}
Group={{ postgres_group }}
OOMScoreAdjust=-1000
Environment=PGDATA={{ postgres_data_dir }}
StandardOutput=syslog
ExecStart={{ postgres_bin_dir }}/postmaster -D ${PGDATA}
{% if postgres_coredump_filter is defined %}
ExecStartPost=/bin/bash -c 'echo {{ postgres_coredump_filter }} > /proc/$MAINPID/coredump_filter'
PermissionsStartOnly=true
{% endif %}
ExecReload=/bin/kill -HUP $MAINPID
KillMode=mixed
KillSignal=SIGINT
Restart=on-failure
LimitCORE=infinity

[Install]
WantedBy=multi-user.target
