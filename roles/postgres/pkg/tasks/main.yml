---

# Copyright Â© EnterpriseDB Corporation

# Given a Postgres version, we perform distribution-specific tasks to
# install the required Postgres packages. (The required repositories
# were already configured by sys/pkg.)

- include_tasks: list-packages.yml

- name: Install Postgres packages
  package:
    name: "{{ all_postgres_packages }}"
    state: present
  notify:
  - Note Postgres restart required

# Due to the differences in the handling of debuginfo/dbgsym/dbg
# packages between distributions and repositories, we handle them
# separately.

- include_tasks:
    file: debuginfo.yml
    apply:
      tags: debuginfo
  tags: debuginfo

# We install our own service units later, so we disable the packaged
# versions here.

- name: Disable default postgresql services
  systemd:
    name: "{{ default_postgres_service_names[postgres_family][ansible_os_family] }}"
    state: stopped
    masked: yes
  tags: service
