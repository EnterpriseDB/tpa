pgxcOwner=postgres
pgxcUser=postgres
tmpDir=/tmp
localTmpDir=$tmpDir

configBackup=n

dataDirRoot=$HOME

#---- GTM ------------------------------------------------------------------------------------
gtmName=gtm

gtmMasterServer={% cluster_hostname %}
gtmMasterPort=20000
gtmMasterDir=$dataDirRoot/gtm

gtmExtraConfig=none
gtmMasterSpecificExtraConfig=none

gtmSlave=n

#---- GTM Proxy -------------------------------------------------------------------------------------------------------
gtmProxyDir=$dataDirRoot/gtm_pxy

gtmProxy=y

# XXX Does this need to be gtm_pxy1 gtm_pxy2 even if they are on separate
# servers?
gtmProxyNames=({% (['gtm_pxy']*(groups['tag_role_datanode']|difference(groups['tag_role_gtm'])|length))|join(' ') %})
gtmProxyServers=({% groups['tag_role_datanode']|difference(groups['tag_role_gtm'])|join(' ') %})
gtmProxyPorts=({% (['20001']*(groups['tag_role_datanode']|difference(groups['tag_role_gtm'])|length))|join(' ') %})
gtmProxyDirs=({% (['$gtmProxyDir']*(groups['tag_role_datanode']|difference(groups['tag_role_gtm'])|length))|join(' ') %})

gtmPxyExtraConfig=none

#---- Coordinators ----------------------------------------------------------------------------------------------------
coordMasterDir=$dataDirRoot/coord_master
coordSlaveDir=$HOME/coord_slave
coordArchLogDir=$HOME/coord_archlog

# XXX Does this need to be coord1 coord2 even if they are on separate
# servers?
coordNames=({% (['coord']*(groups['tag_role_coordinator']|length))|join(' ') %})
coordPorts=({% (['30000']*(groups['tag_role_coordinator']|length))|join(' ') %})
poolerPorts=({% (['30001']*(groups['tag_role_coordinator']|length))|join(' ') %})
coordPgHbaEntries=(::1/128)

coordMasterServers=({% [groups['tag_role_coordinator']]|join(' ') %})
coordMasterDirs=({% (['$coordMasterDir']*(groups['tag_role_coordinator']|length))|join(' ') %})
coordMaxWALsender=5
coordMaxWALSenders=({% (['$coordMaxWALsender']*(groups['tag_role_coordinator']|length))|join(' ') %})

coordSlave=n

#---- Configuration files---
coordExtraConfig=coordExtraConfig
cat > $coordExtraConfig <<EOF
#================================================
# Added to all the coordinator postgresql.conf
# Original: $coordExtraConfig
log_destination = 'stderr'
logging_collector = on
log_directory = 'pg_log'
log_line_prefix = '%p:%v:%x:%m:%C:%R'
#trace_locks = true
listen_addresses = '*'
max_connections = 100
max_prepared_transactions = 100
hot_standby = off
log_min_messages=debug1
log_min_duration_statement=0
log_error_verbosity=verbose
#autovacuum=off
EOF

coordSpecificExtraConfig=(none none)
coordSpecificExtraPgHba=(none none)

#---- Datanodes -------------------------------------------------------------------------------------------------------
datanodeMasterDir=$dataDirRoot/dn_master
datanodeSlaveDir=$dataDirRoot/dn_slave
datanodeArchLogDir=$dataDirRoot/datanode_archlog

primaryDatanode=datanode_1
datanodeNames=(datanode_1 datanode_2 datanode_3 datanode_4)
datanodePorts=(40001 40002 40003 40004)
datanodePoolerPorts=(40011 40012 40013 40014)
datanodePgHbaEntries=(::1/128)

datanodeMasterServers=(localhost localhost localhost localhost)
datanodeMasterDirs=($datanodeMasterDir.1 $datanodeMasterDir.2 $datanodeMasterDir.3 $datanodeMasterDir.4)
datanodeMaxWalSender=5
datanodeMaxWALSenders=($datanodeMaxWalSender $datanodeMaxWalSender $datanodeMaxWalSender $datanodeMaxWalSender)

datanodeSlave=n

datanodeExtraConfig=datanodeExtraConfig	
cat > $datanodeExtraConfig <<EOF
#================================================
# Added to all the datanode postgresql.conf
# Original: $datanodeExtraConfig
log_destination = 'stderr'
logging_collector = on
log_directory = 'pg_log'
log_line_prefix = '%p:%v:%x:%m:%C:%R'
#trace_locks = true
listen_addresses = '*'
max_connections = 100
max_prepared_transactions = 100
hot_standby = off
log_min_messages=debug1
log_min_duration_statement=0
log_error_verbosity=verbose
#autovacuum=off
EOF
