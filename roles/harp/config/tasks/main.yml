---

# Â© Copyright EnterpriseDB UK Limited 2015-2022 - All rights reserved.

# Both versions of harp want their harp_directory to be owned by
# postgres_user; we must make sure it exists even on harp-proxy
# instances.

- include_role:
    name: postgres/user
    apply:
      tags: user
  when: >
    'postgres' not in role
  tags: user

- name: Ensure harp directory exists
  file:
    path: "{{ harp_directory }}"
    state: directory
    owner: "{{ postgres_user }}"
    group: "{{ postgres_group }}"
  when:
    initialise_harp|bool
  tags: config

- name: Install HARP configuration
  include_tasks:
    file: "harp{{ harp_version }}.yml"
    apply:
      tags: config
  tags: config
