---

# Â© Copyright EnterpriseDB UK Limited 2015-2021 - All rights reserved.

- assert:
    msg: HARP v2 must be installed on a BDR cluster
    that: >
      'bdr' in role or 'harp-proxy' in role

- assert:
    msg: HARP v2 must use single harp_location when harp_consensus_protocol is 'BDR'
    that: >
      groups[bdr_node_group]|map('extract', hostvars, 'harp_location')|unique|length == 1
  when: harp_consensus_protocol == 'bdr'

- include_role:
    name: harp/pkg
    apply:
      tags: pkg
  when:
    platform not in ['shared']
  tags: pkg

- include_role:
    name: harp/config
    apply:
      tags: config
  tags: config
