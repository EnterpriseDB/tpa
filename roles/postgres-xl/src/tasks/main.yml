---

# Copyright Â© 2ndQuadrant Limited <info@2ndquadrant.com>

- include_role: name=postgres/src
  vars:
    postgres_git_url: "{{ pgxl_git_url }}"
    postgres_git_ref: "{{ pgxl_git_ref }}"
    postgres_src_dir: "{{ pgxl_src_dir }}"
    postgres_build_dir: "{{ pgxl_build_dir }}"
    postgres_install_dir: "{{ pgxl_install_dir }}"
  tags: always

- include_role: name=postgres/user
  vars:
    postgres_bin_dir: /opt/pgxl/bin
    extra_bashrc_lines:
      - export LD_LIBRARY_PATH=/opt/pgxl/lib:$LD_LIBRARY_PATH
      - export PGPORT=20002
  tags: always

- name: Install additional Postgres-XL related packages
  package:
    name: "{{ pgxl_extra_packages[ansible_distribution] }}"
    state: latest
  tags: [pgxl, pkg]
