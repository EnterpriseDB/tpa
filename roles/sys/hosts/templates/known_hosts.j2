{% for h in groups[cluster_tag] %}
{%   for a in hostvars[h].ip_addresses+['inventory_hostname'] %}
{%     for k in ['rsa', 'ecdsa'] %}
{%       set hostname = hostvars[h][a] %}
{%       if ansible_ssh_port|default(22) != 22 %}
{%         set hostname = '[%s]:%s' % (hostname, ansible_ssh_port) %}
{%       endif %}
{{ hostname }} {{ lookup('file', '%s/hostkeys/ssh_host_%s_key.pub' % (playbook_dir, k)) }}
{%     endfor %}
{%   endfor %}
{% endfor %}
