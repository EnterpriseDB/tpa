---

- name: Ensure {{cluster_dir}}/hostkeys exists locally
  file:
    path: "{{ cluster_dir }}/hostkeys"
    state: directory

- name: Generate RSA and ECDSA host keys
  command: ssh-keygen -t {{ item }} -N "" -C "{{ cluster_name }}" -f ssh_host_{{ item }}_key
  args:
    chdir: "{{ cluster_dir }}/hostkeys"
    creates: "ssh_host_{{ item }}_key"
  with_items:
    - rsa
    - ecdsa
