---

# monitoring/client/tasks/main.yml
#
# Add a client server to monitoring.

- name: Get the nsca password from the vault
  include_vars: "{{ playbook_dir }}/vault/nsca_password.yml"
  no_log: true

- name: Set up client server scripts for standard monitoring
  include: add-monitoring.yml
  when: (monitoring|bool == true) and (server_role == "database")

- name: Set up client server scripts for barman monitoring
  include: add-barman-monitoring.yml
  when: (monitoring|bool == true) and (server_role == "barman")

- name: Remove client server monitoring scripts
  include: remove-monitoring.yml
  when: (monitoring|bool == false) and (server_role == "database")
