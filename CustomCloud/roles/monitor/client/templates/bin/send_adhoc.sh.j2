#!/bin/bash
#
# {{ansible_managed}}

# This script should be installed on servers where 2ndq
# is not able to edit the user crontab; it can be modified
# to enable ad-hoc cron scripts without interfering with
# the main monitoring scripts and without having to
# request changes from the client's IT team.
#
# As it's Ansible-managed, changes should be made in the
# RDBA repository otherwise manual changes on the client
# server would be overwritten on the next Ansible run.
#
{# Ensure any changes are customer-specific, e.g.:#}

# {% if client_identifier == "foo" %}
# ...
# {% endif %}


{% if client_identifier == "lastfm" %}

{% if replication_type != "standby" %}
# send_icinga_freeze
# ------------------
{% include 'send_icinga_freeze.sh.j2' %}

{% endif %}

# send_icinga_pg_version
# ----------------------

# Only do this check during two periods daily
if [ `date +%I` -eq "07" ]; then

{% include 'send_icinga_pg_version.sh.j2' %}

fi

{% if check_pgpool|bool == true %}
# send_icinga_pgpool
# ------------------

{% include 'send_icinga_pgpool.sh.j2' %}

{% endif %}

{% endif %} # if client_identifier == "lastfm"
