# Modules
$ModLoad imuxsock.so
$ModLoad imklog.so
$ModLoad imudp.so
$ModLoad imtcp.so

# Listen on network
$UDPServerAddress 0.0.0.0
$UDPServerRun 514
$InputTCPServerAddress 0.0.0.0
$InputTCPServerRun 514

# Enable non-kernel facility klog messages
$KLogPermitNonKernelFacility on

# Reduce any duplicates
$RepeatedMsgReduction on
# Enable disk mode for receive buffer
$WorkDirectory /var/spool/rsyslog
$MainMsgQueueFileName mainq

# Permissions
$FileOwner syslog
$FileGroup adm
$FileCreateMode 0640
$DirCreateMode 0755
$Umask 0022
$PrivDropToUser syslog
$PrivDropToGroup syslog

# Basic local logging
*.info;\
	mail.none;\
	authpriv.none;\
	cron.none		/var/log/messages

auth,authpriv.*			/var/log/auth.log
kern.*					-/var/log/kern.log
mail.*					-/var/log/mail.log
cron.*					/var/log/cron.log

*.emerg					:omusrmsg:*

# Configure per host logging for postgresql
$template DailyPerHostLogs,"/var/log/hosts/%HOSTNAME%/%PROGRAMNAME%.%$YEAR%-%$MONTH%-%$DAY%.log"
if $programname == 'postgres' then -?DailyPerHostLogs;RSYSLOG_FileFormat
