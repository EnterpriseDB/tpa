---

allow_duplicates: yes
dependencies:
    - role: 'postgres/pkg'
      apt_repositories:
        PGDG:
          key_id: ACCC4CF8
          key_url: https://www.postgresql.org/media/keys/ACCC4CF8.asc
          repo: >-
            deb http://apt.postgresql.org/pub/repos/apt/ {{ ansible_distribution_release }}-pgdg main
          versions: [9.4]
        BDR:
          key_id: AA7A6805
          key_url: http://packages.2ndquadrant.com/bdr/apt/AA7A6805.asc
          repo: "deb http://packages.2ndquadrant.com/bdr/apt/ {{ ansible_distribution_release }}-2ndquadrant main"
          versions: [9.4]
      yum_repositories:
        PGDG:
          rpm_url: >-
            http://yum.postgresql.org/{{pgversion}}/redhat/rhel-7-x86_64/pgdg-redhat{{pgversionNN}}-{{pgversion}}-3.noarch.rpm
          versions: [9.4]
        BDR:
          rpm_url: >-
            http://packages.2ndquadrant.com/postgresql-bdr{{ pgversionNN }}-2ndquadrant/yum-repo-rpms/postgresql-bdr{{ pgversionNN }}-2ndquadrant-redhat-latest.noarch.rpm
          versions: [9.4]
      postgres_packages:
        Debian: &debian_packages
          - postgresql-bdr-{{ pgversion }}
          - postgresql-bdr-{{ pgversion }}-dbg
          - postgresql-bdr-client-{{pgversion}}
          - postgresql-bdr-contrib-{{pgversion}}
          - postgresql-bdr-server-dev-{{pgversion}}
          - postgresql-bdr-{{pgversion}}-bdr-plugin
        RedHat:
          - postgresql-bdr{{pgversionNN}}-bdr
          - postgresql-bdr{{pgversionNN}}-debuginfo
          - postgresql-bdr{{pgversionNN}}-contrib
          - postgresql-bdr{{pgversionNN}}-server
          - postgresql-bdr{{pgversionNN}}-devel
          - postgresql-bdr{{pgversionNN}}-libs
          - postgresql-bdr{{pgversionNN}}-plperl
        Ubuntu: *debian_packages

