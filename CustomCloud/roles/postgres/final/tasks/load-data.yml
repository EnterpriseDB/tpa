---

- name: Determine if pgbench -i was run already
  postgresql_query:
    conninfo: "dbname=postgres user=postgres"
    query: >
      select count(*) from information_schema.tables where table_name='pgbench_history'
  register: pgbench
  become_user: postgres
  become: yes

- include_role: name=pgbench/init
  when:
    pgbench.count == 0
