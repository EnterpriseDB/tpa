#!/bin/bash
#
# Runs provision/deprovision/deploy etc.

IFS=
set -e -u

TOP=$(dirname $0)/..
type realpath &>/dev/null && TOP=$(realpath $TOP)
export TPA_DIR=${TPA_DIR:-$TOP}

command=${1:?No command specified}
shift

case "$command" in
    # We pass selected subcommands through to existing scripts.
    provision|deprovision|deploy|rehydrate)
        $TPA_DIR/bin/$command "$@"
        ;;
    info|version)
        echo "TPA $(cat $TPA_DIR/VERSION.md)"
        ;;
    *)
        echo "Unrecognised command: $command"
        ;;
esac
