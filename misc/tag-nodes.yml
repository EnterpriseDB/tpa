---

- hosts: localhost
  gather_facts: no
  tasks:
    - assert:
        that:
          - cluster_name is defined
    - ec2_tag: state=present region="{{ hostvars[item.1].ec2_region }}" resource="{{ hostvars[item.1].ec2_id }}"
      args:
        tags:
          node: "{{ 1+item.0 }}"
      with_indexed_items: "{{ groups['tag_Name_' + cluster_name] }}"
