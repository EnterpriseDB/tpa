---

# Quick hack:
#
# Can be used to regenerate /etc/hosts on all instances in a cluster.
# This must be invoked in the context of the cluster's inventory. The
# relative paths may need changing, depending on where the playbook is.

- name: Set up inventory variables
  hosts: all
  any_errors_fatal: True
  max_fail_percentage: 0
  tasks:
    - include: ../platforms/aws/hostvars.yml
      tags: always
    - name: Generate /etc/hosts
      template:
        src: ../roles/sys/hosts/templates/hosts.j2
        dest: /etc/hosts
        owner: root
        group: root
        mode: 0644
