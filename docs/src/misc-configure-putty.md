# TPA - PuTTY configuration guide

You can use PuTTY under Windows to connect by way of ssh to the AWS instances
that were created by the TPA utility `tpaexec provision`. To do so, you need to convert the keys
from the private key format (`.pem`) generated by Amazon EC2
to the PuTTY format (`.ppk`).

    # Provision the cluster
    [tpa]$ tpaexec provision <clustername>

The PuTTY tool PuTTYgen can convert keys to the required
format.

## Key conversion

Before you convert the key, first locate the private key and save it as a `.pem` file.

### 1. Locate private key

Locate the private key in the cluster directory `<clustername>`. It's 
named according to the `cluster_name` variable set in `config.yml` and has the prefix
`id_`. For example, if the cluster_name is set to `testenv1`, then the private
key is `id_testenv1`.

### 2. Save key as .pem

Copy the private key file into your Windows filesystem and save it as a `.pem` file, in this
example `id_testenv1.pem`. Copying and pasting into a text file works fine
for this.

### 3. Convert key

1. Start PuTTYgen and, under **Parameters**, select the appropriate type of key to
generate. For older versions of PuTTYgen, select **SSH-2 RSA**. For recent versions,
select **RSA**.

!!! Note
    Don't select **SSH-1 (RSA)**.

1. Select **Load**. In the box labeled **PuTTY Private Key Files (*.ppk)**,
select **All Files (\*.\*)**.

1. Select your `.pem` file and select **Open**. Then select **OK**.

1. Select **Save private key**, and select **Yes** to ignore the warning about saving
the key without a passphrase. Make sure that the file suffix is `.ppk`, and
choose the same name as for the `.pem` file. In this example, the filename
is `id_testenv1.ppk`.

## Configure PuTTY

1. Start PuTTY and, from the **Category** window, select **Session**. 

1. In the **Host Name** panel, enter `<user>@<IP address>`. In the **Port** panel, enter
**22**,

    You can find the `<user>` and `<IP address>` values in the `<clustername>/ssh_config`
    file that's created by the `tpaexec provision` utility.

1. In the PuTTY **Category** window, select **Connection**. Expand **SSH** and
select **Auth**.

1. For the panel labeled **Private key file for authentication**, select **Browse**
and select the `.ppk` file that you saved earlier. Then select **Open**.

1. In the PuTTy **Category** window, select **Session** again. Enter a session name
in **Saved Sessions**, and select **Save**.

You can now connect to the AWS host by way of PuTTY by selecting this
saved session.
