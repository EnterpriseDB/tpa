#!/usr/bin/env python

from __future__ import print_function

import sys

try:
    from tpaexec.architecture import Architecture
except:
    print('Please invoke via: tpaexec configure <clustername> --architecture <archname>')
    sys.exit(-1)

class BDR_Always_ON(Architecture):
    def argument_defaults(self):
        return {
            'barman_volume_size': 128,
            'postgres_volume_size': 64,
            'tpa_2q_repositories': [
                'products/bdr3/release',
                'products/pglogical3/release',
            ]
        }

    def num_instances(self):
        return 8

    def num_locations(self):
        return 1

    def update_cluster_vars(self, cluster_vars):
        cluster_vars.update({
            'repmgr_failover': 'manual',
            'postgres_coredump_filter': '0xff',
            'extra_postgres_extensions': ['pglogical'],
        })

if __name__ == '__main__':
    BDR_Always_ON().configure()
