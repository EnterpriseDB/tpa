---

# Copyright Â© 2ndQuadrant Limited <info@2ndquadrant.com>

- import_playbook: "{{ tpa_dir }}/architectures/lib/init.yml"

- name: Set up TPA image nodes
  any_errors_fatal: True
  max_fail_percentage: 0
  become_user: root
  become: true

  hosts: all
  tasks:
    - include_role: name=common/pkg
    - include_role: name=postgres/pkg
    - include_role: name=sys/openvpn/pkg
    - include_role: name=pgbouncer/pkg
    - include_role: name=barman/pkg
    - include_role: name=repmgr/pkg

    - include_role: name=sys/upgrade
    - include_role: name=sys/firstboot
