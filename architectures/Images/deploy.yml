---

# Â© Copyright EnterpriseDB UK Limited 2015-2021 - All rights reserved.

- import_playbook: "{{ tpa_dir }}/architectures/lib/init.yml"
  vars:
    wait_for_instances: yes
  tags: always

- name: Set up TPA image nodes
  any_errors_fatal: True
  max_fail_percentage: 0
  become_user: root
  become: true
  environment: "{{ target_environment }}"
  hosts: all
  tasks:
  - include_role: name=sys/pkg
  - include_role: name=postgres/pkg
  - include_role: name=sys/openvpn/pkg
  - include_role: name=pgbouncer/pkg
  - include_role: name=barman/pkg
  - include_role: name=repmgr/pkg
  - include_role: name=sys/upgrade
  - include_role: name=sys/firstboot
