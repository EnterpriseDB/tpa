#!/usr/bin/env python
# -*- coding: utf-8 -*-
# Copyright Â© 2ndQuadrant Limited <info@2ndquadrant.com>

import sys

try:
    from tpaexec.architecture import Architecture
except:
    print('Please invoke via: tpaexec configure <clustername> --architecture <archname>')
    sys.exit(-1)

class M1(Architecture):
    def add_architecture_options(self, p, g):
        g.add_argument(
            '--num-cascaded-replicas', type=int, metavar='N',
            help='number of replicas cascaded from first replica',
            dest='cascaded_replicas', default=1
        )

    def argument_defaults(self):
        return {
            'repmgr_package_version': '4.0.6*',
        }

    def num_instances(self):
        return 3+self.args.get('cascaded_replicas', 1)

    def num_subnets(self):
        return 2

    def update_cluster_vars(self, cluster_vars):
        cluster_vars.update({
            'vpn_network': '192.168.33.0/24',
        })

if __name__ == '__main__':
    M1().configure()
