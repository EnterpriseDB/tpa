---

# These tasks bring the managed node's Python installation up to
# Ansible's expectations. (We install pip only for convenience.)

- name: Install pip
  apt: name=python-pip state=latest
  sudo: yes

# If we have neither ssl.match_hostname (included in Python â‰¥ 2.7.9) or
# backports.ssl_match_hostname, we need to install the latter using pip.
# It's easier to check the version, and since running "pip install foo"
# twice should have no effect the second time, that's what we do here.

- name: Is this Python old enough to need backports.ssl_match_hostname? (< 2.7.9)
  command: python -c 'import sys; print sys.version_info[:3] < (2, 7, 9)'
  register: version

- name: Install backports.ssl_match_hostname
  command: pip install backports.ssl_match_hostname
  when: version.stdout=='True'
