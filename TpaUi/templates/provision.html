{% extends "base.html" %}
{% load staticfiles %}
{% block content %}
<div class="row">
<div class = "col-md-3">
</div>
<div class="col-md-6 table-responsive">
    <div class="box text-center">
    <h3>Trusted PostgreSQL Provisioning</h3>
    <span class="badge">Step {{wizard.steps.step1}} of {{wizard.steps.count}}</span>
    <hr />
    {%for field in form%}
        {{field.error}}
    {%endfor%}
    </div>
    

<form  id ="provision" class="form-horizontal" role="form" action="/provision/" method="post">{% csrf_token %}
<!--<table class="table table-hover text-right">-->
{{wizard.management_form}}
{% if wizard.form.forms %}
    {{ wizard.form.management_form }}
    {{ formset.management_form }}
    {% for form in wizard.form.forms %}
        <h4 class="text-right"><span class="label label-primary text-large">Instance-{{forloop.counter}}</span></h4>
        {% for field in form %}
            <div class="form-group fieldWrapper">
                {{ field.errors }}
                <label class="control-label col-sm-5 pull-left" for="{{ field.auto_id }}">{{ field.label }}</label>
                <div class="col-sm-7"> {{ field }} </div>
                {% if field.help_text %}
                    <p class="help">{{ field.help_text|safe }}</p>
                {% endif %}
            </div>
        {% endfor %}
        <hr />
    {% endfor %}
{% else %}
    {% for field in wizard.form %}
            {% ifequal field.label '' %}
                <h4 class="text-right"><span class="label label-primary text-large">{{field.value}}</span></h4>
            {% endifequal %}                
            <div class="form-group fieldWrapper">
                {{ field.errors }}
                <label>{{ field.widget }}</label>
                <label class="control-label col-sm-5 float-left" for="{{ field.auto_id }}">{{ field.label }}</label>
                <div class="col-sm-7"> {{ field }} </div>
                {% if field.help_text %}
                    <p class="help">{{ field.help_text|safe }}</p>
                {% endif %}
            </div>
    {% endfor %}
    
{% endif %}
<!--</table>-->
<hr />
<div class="btn-toolbar text-center">
{% if wizard.steps.prev %}
<button name="wizard_goto_step" type="submit" class="btn btn-primary" value="{{ wizard.steps.prev }}">Previous</button>
{% endif %}
{% if wizard.steps.next %}
<input type="submit" class="btn btn-primary" value="Next"/>
{% else %}
<input type="submit" class="btn btn-primary" value="Finish"/>
{% endif %}

</div>
<hr />
</form>

</div>

</div>
<!--<script src="//ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
<script type="text/javascript">
        /**
 * jQuery Formset 1.1
 * @author Stanislaus Madueke (stan DOT madueke AT gmail DOT com)
 * @requires jQuery 1.2.6 or later
 *
 * Copyright (c) 2009, Stanislaus Madueke
 * All rights reserved.
 *
 * Licensed under the New BSD License
 * See: http://www.opensource.org/licenses/bsd-license.php
 */
(function($) {
    $.fn.formset = function(opts)
    {
        var options = $.extend({}, $.fn.formset.defaults, opts);

        var updateElementIndex = function(el, prefix, ndx) {
            var id_regex = new RegExp('(' + prefix + '-\\d+)');
            var replacement = prefix + '-' + ndx;
            if ($(el).attr("for")) $(el).attr("for", $(el).attr("for").replace(id_regex, replacement));
            if (el.id) el.id = el.id.replace(id_regex, replacement);
            if (el.name) el.name = el.name.replace(id_regex, replacement);
        };

        $(this).each(function(i) {
            $(this).addClass(options.formCssClass);
            if ($(this).is('TR')) {
                // If the forms are laid out in table rows, insert
                // the remove button into the last table cell:
                $(this).children(':last').append('<a class="' + options.deleteCssClass +'" href="javascript:void(0)">' + options.deleteText + '</a>');
            } else if ($(this).is('UL') || $(this).is('OL')) {
                // If they're laid out as an ordered/unordered list,
                // insert an <li> after the last list item:
                $(this).append('<li><a class="' + options.deleteCssClass + '" href="javascript:void(0)">' + options.deleteText +'</a></li>');
            } else {
                // Otherwise, just insert the remove button as the
                // last child element of the form's container:
                $(this).append('<a class="' + options.deleteCssClass + '" href="javascript:void(0)">' + options.deleteText +'</a>');
            }
            $(this).find('a.' + options.deleteCssClass).click(function() {
                // Remove the parent form containing this button:
                var row = $(this).parents('.' + options.formCssClass);
                row.remove();
                // If a post-delete callback was provided, call it with the deleted form:
                if (options.removed) options.removed(row);
                // Update the TOTAL_FORMS form count.
                // Also, update names and ids for all remaining form controls
                // so they remain in sequence:
                var forms = $('.' + options.formCssClass);
                $('#id_' + options.prefix + '-TOTAL_FORMS').val(forms.length);
                // If there's only one form left, disable its delete button:
                if (forms.length == 1) { $('a.' + options.deleteCssClass).hide(); }
                for (var i=0, formCount=forms.length; i<formCount; i++) {
                    $(forms.get(i)).find('input,select,textarea,label').each(function() {
                        updateElementIndex(this, options.prefix, i);
                    });
                }
                return false;
            });
        });

        if ($(this).length) {
            var $addBtn;
            if ($(this).attr('tagName') == 'TR') {
                // If forms are laid out as table rows, insert the
                // "add" button in a new table row:
                var numCols = this.eq(0).children().length;
                $(this).parent().append('<tr><td colspan="' + numCols + '"><a class="' + options.addCssClass + '" href="javascript:void(0)">' + options.addText + '</a></tr>');
                $addBtn = $(this).parent().find('tr:last a');
            } else {
                // Otherwise, insert it immediately after the last form:
                $(this).filter(':last').after('<a class="' + options.addCssClass + '" href="javascript:void(0)">' + options.addText + '</a>');
                $addBtn = $(this).filter(':last').next();
            }
            $addBtn.click(function() {
                var nextIndex = parseInt($('#id_' + options.prefix + '-TOTAL_FORMS').val());
                var row = $('.' + options.formCssClass + ':first').clone(true).get(0);
                $(row).removeAttr('id').insertAfter($('.' + options.formCssClass + ':last'));
                $(row).find('input,select,textarea,label').each(function() {
                    updateElementIndex(this, options.prefix, nextIndex);
                    // If this is a checkbox or radiobutton, set uncheck it.
                    // Fix for Issue 1, reported by Wilson.Andrew.J:
                    var elem = $(this);
                    if (elem.is('input:checkbox') || elem.is('input:radio')) {
                        elem.attr('checked', false);
                    } else {
                        elem.val('');
                    }
                });
                var formCount = nextIndex + 1;
                $('#id_' + options.prefix + '-TOTAL_FORMS').val(formCount);
                // If we've got more than one form, enable delete buttons:
                if (formCount > 1) { $('a.' + options.deleteCssClass).show(); }
                // If a post-add callback was supplied, call it with the added form:
                if (options.added) options.added($(row));
                return false;
            });
        }

        // If the formset is initialized with a single form, hide the delete button:
        if ($(this).length == 1) { $('a.' + options.deleteCssClass).hide(); }

        return $(this);
    }

    /* Setup plugin defaults */
    $.fn.formset.defaults = {
        prefix: 'form',                  // The form prefix for your django formset
        addText: 'add another',          // Text for the add link
        deleteText: 'remove',            // Text for the delete link
        addCssClass: 'add-row',          // CSS class applied to the add link
        deleteCssClass: 'delete-row',    // CSS class applied to the delete link
        formCssClass: 'dynamic-form',    // CSS class applied to each form in a formset
        added: null,                     // Function called each time a new form is added
        removed: null                    // Function called each time a form is deleted
    }
})(jQuery)
</script>
<script type="text/javascript">
    $(function() {
        $('#provision tbody tr').formset(); 
    })
</script>-->
{%endblock%}