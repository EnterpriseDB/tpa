---

- name: Set up TPA image nodes
  any_errors_fatal: True
  max_fail_percentage: 0
  become_user: root
  become: true

  hosts: all
  roles:
    - role: platforms
      become: no

    - role: postgres/vars

    - role: common/pkg
    - role: postgres/pkg
      vars:
        postgres_package_source: 2ndQPostgres
    - role: pglogical/pkg
    - role: sys/openvpn/pkg
    - role: pgbouncer/pkg
    - role: barman/pkg
    - role: repmgr/pkg

    - role: sys/upgrade
    - role: sys/firstboot
