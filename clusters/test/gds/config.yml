---

# GDS test cluster

cluster_name: "gds"
cluster_tags:
  Owner: gulcin

cluster_vars:
  cluster_network: 10.33.67.0/24
  vpn_network: 192.168.33.0/24

ec2_ami:
  Name: debian-jessie-amd64-hvm-2016-04-03-ebs
ec2_ami_user: admin

ec2_vpc:
  Name: Test

ec2_vpc_subnets:
  eu-west-1:
    10.33.67.16/28:
      az: eu-west-1b
    10.33.67.32/28:
      az: eu-west-1c
    10.33.67.48/28:
      az: eu-west-1b
    10.33.67.64/28:
      az: eu-west-1c
  eu-central-1:
    10.33.67.80/28:
      az: eu-central-1a
    10.33.67.96/28:
      az: eu-central-1b
    10.33.67.112/28:
      az: eu-central-1a
    10.33.67.128/28:
      az: eu-central-1b
    10.33.67.144/28:
      az: eu-central-1b

instances:
    # One BDR master instance, two physical replicas, and a corresponding Barman instance
    # in each of the local clusters on two regions, plus a control node.

    - node: 1
      type: t2.micro
      region: eu-west-1
      subnet: 10.33.67.16/28
      tags:
        role:
          - bdr
          - primary
        backup: barman-eu-west-1
        log: cluster-control

    - node: 2
      type: t2.micro
      region: eu-west-1
      subnet: 10.33.67.32/28
      tags:
        role: barman
        log: cluster-control
        Name: barman-eu-west-1

    - node: 3
      type: t2.micro
      region: eu-west-1
      subnet: 10.33.67.48/28
      tags:
        role:
          - bdr
          - replica
        backup: barman-eu-west-1
        log: cluster-control

    - node: 4
      type: t2.micro
      region: eu-west-1
      subnet: 10.33.67.64/28
      tags:
        role:
          - bdr
          - replica
        backup: barman-eu-west-1
        log: cluster-control

    - node: 5
      type: t2.micro
      region: eu-central-1
      subnet: 10.33.67.80/28
      tags:
        role:
          - bdr
          - primary
        backup: barman-eu-central-1
        log: cluster-control

    - node: 6
      type: t2.micro
      region: eu-central-1
      subnet: 10.33.67.96/28
      tags:
        role: barman
        log: cluster-control
        Name: barman-eu-central-1

    - node: 7
      type: t2.micro
      region: eu-central-1
      subnet: 10.33.67.112/28
      tags:
        role:
          - bdr
          - replica
        backup: barman-eu-central-1
        log: cluster-control

    - node: 8
      type: t2.micro
      region: eu-central-1
      subnet: 10.33.67.128/28
      tags:
        role:
          - bdr
          - replica
        backup: barman-eu-central-1
        log: cluster-control

    - node: 9
      type: t2.micro
      region: eu-central-1
      subnet: 10.33.67.144/28
      assign_elastic_ip: yes
      tags:
        role: control, backup, openvpn-server, log-server, pgbouncer
        Name: cluster-control
