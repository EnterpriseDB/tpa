- name: Delete a container
  lxd_container:
    url: "{{ item.lxd_url | default('unix:/var/snap/lxd/common/lxd/unix.socket') }}"
    name: "{{ item.Name }}"
    state: absent
  with_items:
    - "{{ instances }}"

- name: Delete generated files for this cluster
  file:
    path: "{{ cluster_dir }}/{{ item }}"
    state: absent
    force: yes
  with_items:
    - inventory/lxd.py
    - inventory/lxd.ini
