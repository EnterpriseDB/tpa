---

# Copyright Â© 2ndQuadrant Limited <info@2ndquadrant.com>

- name: Link to ec2.py from inventory directory
  file:
    src: "{{ tpa_dir }}/platforms/aws/inventory/ec2.py"
    dest: "{{ cluster_dir }}/inventory/ec2.py"
    state: link
    force: yes

- name: Install customised ec2.ini
  template:
    src: ec2.ini.j2
    dest: "{{ cluster_dir }}/inventory/ec2.ini"

- name: Remove old inventory cache
  file:
    path: "{{ item }}"
    state: absent
  with_fileglob:
    - "{{ cluster_dir }}/tmp/ansible-ec2*.cache"
    - "{{ cluster_dir }}/tmp/ansible-ec2*.index"
