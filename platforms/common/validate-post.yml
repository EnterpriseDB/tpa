---

- name: Ensure cluster_networks/cluster_network is set
  assert:
    msg: "Please define cluster_networks (list) or cluster_network (scalar)"
    that:
      - ('cluster_network' in cluster_vars or
        'cluster_networks' in cluster_vars)

- name: Convert cluster_network to cluster_networks
  set_fact:
    cluster_vars: "{{
      cluster_vars|remove_keys(['cluster_network'])|combine({'cluster_networks': [n]})
    }}"
  when:
    n is string and 'cluster_networks' not in cluster_vars
  vars:
    n: "{{ cluster_vars.get('cluster_network', []) }}"
