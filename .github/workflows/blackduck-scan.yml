name: Foundation-Security/Black Duck Scan

on:
  push:
    tags:
      - '**'
  workflow_dispatch:

jobs:
  Blackduck-Scan:
    runs-on: ubuntu-20.04

    steps:
      - name: Trigger Workflow
        uses: actions/github-script@v6
        env:
          REPOSITORY: ${{ github.repository }}
          REF: ${{ github.ref }}
        with:
          github-token: ${{ secrets.TPAEXEC_CI }}
          script: |
            await github.rest.actions.createWorkflowDispatch({
              owner: 'EnterpriseDB',
              repo: 'tpaexec-ci',
              workflow_id: 'blackduck-scan.yml',
              ref: 'master',
              inputs: {
                repository: process.env.REPOSITORY,
                ref: process.env.REF
              },
            })
