[tox]
envlist = py36-lint, py36-test, dep
skipsdist = True
toxworkdir = {env:TOX_WORK_DIR:.tox}
skip_missing_interpreters = True

[testenv]
setenv =
    PYTHONPATH = architectures/lib
    PYTHONDONTWRITEBYTECODE = 1
    PIP_INDEX_URL = https://pypi.org/simple
deps =
    -rrequirements.txt
    -rrequirements/ansible.txt
    {lint,test}: -rrequirements/testing.txt
    dep: pipdeptree
commands =
    lint: prospector -DFM
    test: pytest -p no:cacheprovider ./lib/tests -vv {posargs}
    dep: pipdeptree -w fail

[pytest]
addopts =
    --cov-report term:skip-covered
    --cov-report html:test-output/coverage
    --cov=architectures/lib
    --html=test-output/tests.html
